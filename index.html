<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI Teacher Assistant - KR/VN</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        .loading { display: none; }
        .loading.active { display: block; }
    </style>
</head>
<body class="bg-gray-100 min-h-screen p-5">
    <div class="max-w-2xl mx-auto bg-white p-8 rounded-xl shadow-md">
        <h1 class="text-2xl font-bold mb-6 text-center text-blue-600">ğŸ‡°ğŸ‡· AI í•œêµ­ì–´ ì„ ìƒë‹˜ ğŸ‡»ğŸ‡³</h1>
        
        <div class="mb-6 p-4 bg-yellow-50 rounded-lg">
            <input type="password" id="apiKey" placeholder="Groq API Key ì…ë ¥" class="w-full p-2 border rounded">
            <p class="text-xs text-gray-500 mt-1">* API í‚¤ëŠ” ë¸Œë¼ìš°ì €ì—ë§Œ ì €ì¥ë©ë‹ˆë‹¤.</p>
        </div>

        <div class="mb-6">
            <label class="block mb-2 font-semibold">ì˜¤ëŠ˜ì˜ ê³µë¶€ ë‚´ìš© (í…ìŠ¤íŠ¸/OCR ë³µì‚¬ë³¸):</label>
            <textarea id="studyContent" rows="5" class="w-full p-3 border rounded-lg focus:ring-2 focus:ring-blue-400" placeholder="êµê³¼ì„œ ë‚´ìš©ì„ ì—¬ê¸°ì— ë¶™ì—¬ë„£ìœ¼ì„¸ìš”..."></textarea>
        </div>

        <button onclick="generateQuiz()" id="genBtn" class="w-full bg-blue-500 text-white py-3 rounded-lg font-bold hover:bg-blue-600 transition">
            ë°ì¼ë¦¬ í€´ì¦ˆ 10ê°œ ìƒì„±í•˜ê¸° ğŸš€
        </button>

        <div id="loader" class="loading mt-6 text-center text-gray-600 animate-pulse">
            Groq AIê°€ í€´ì¦ˆë¥¼ ë§Œë“¤ê³  ìˆìŠµë‹ˆë‹¤ (Llama-3.3-70b)...
        </div>

        <div id="quizResult" class="mt-8 space-y-4">
            </div>
    </div>

    <script>
        // ëª¨ë¸ ë¦¬ìŠ¤íŠ¸ (2026ë…„ ê¸°ì¤€ ê°€ìš© ëª¨ë¸ ë…¸í¬ ì „ëµ)
        const MODELS = ["llama-3.3-70b-versatile", "llama-3.1-8b-instant"];

        async function generateQuiz() {
            const apiKey = document.getElementById('apiKey').value || localStorage.getItem('groq_key');
            const content = document.getElementById('studyContent').value;
            
            if (!apiKey || !content) return alert("API í‚¤ì™€ ê³µë¶€ ë‚´ìš©ì„ ì…ë ¥í•´ì£¼ì„¸ìš”!");
            localStorage.setItem('groq_key', apiKey);

            const btn = document.getElementById('genBtn');
            const loader = document.getElementById('loader');
            const resultDiv = document.getElementById('quizResult');

            btn.disabled = true;
            loader.classList.add('active');
            resultDiv.innerHTML = '';

            const systemPrompt = `ë‹¹ì‹ ì€ í•œêµ­ì–´ë¥¼ ê³µë¶€í•˜ëŠ” ë² íŠ¸ë‚¨ì¸ì„ ìœ„í•œ ìµœê³ ì˜ AI ì„ ìƒë‹˜ì…ë‹ˆë‹¤. 
            ì œê³µëœ í…ìŠ¤íŠ¸ë¥¼ ê¸°ë°˜ìœ¼ë¡œ ë°ì¼ë¦¬ í€´ì¦ˆ 10ê°œë¥¼ ë§Œë“œì„¸ìš”.
            - í˜•ì‹: JSON (questions: [{q: "ë¬¸ì œ", options: ["1","2","3","4"], a: 0, explanation: "ë² íŠ¸ë‚¨ì–´ ì„¤ëª…"}])
            - ëª¨ë“  ë¬¸ì œëŠ” í•œêµ­ì–´ì™€ ë² íŠ¸ë‚¨ì–´ë¥¼ ë³‘ê¸°í•˜ì„¸ìš”.
            - í•´ì„¤(explanation)ì€ ë°˜ë“œì‹œ ë² íŠ¸ë‚¨ì–´ë¡œ ì‘ì„±í•˜ì„¸ìš”.`;

            try {
                const response = await fetch("https://api.groq.com/openai/v1/chat/completions", {
                    method: "POST",
                    headers: {
                        "Authorization": `Bearer ${apiKey}`,
                        "Content-Type": "application/json"
                    },
                    body: JSON.stringify({
                        model: MODELS[0],
                        messages: [
                            { role: "system", content: systemPrompt },
                            { role: "user", content: content }
                        ],
                        response_format: { type: "json_object" }
                    })
                });

                const data = await response.json();
                const quizData = JSON.parse(data.choices[0].message.content);
                renderQuiz(quizData.questions);
            } catch (error) {
                console.error(error);
                alert("ì—ëŸ¬ ë°œìƒ! ì½˜ì†”ì„ í™•ì¸í•˜ì„¸ìš”.");
            } finally {
                btn.disabled = false;
                loader.classList.remove('active');
            }
        }

        function renderQuiz(questions) {
            const container = document.getElementById('quizResult');
            questions.forEach((item, idx) => {
                const qEl = document.createElement('div');
                qEl.className = "p-4 border rounded-lg bg-gray-50";
                qEl.innerHTML = `
                    <p class="font-bold mb-2">${idx + 1}. ${item.q}</p>
                    <div class="space-y-1 ml-2">
                        ${item.options.map((opt, i) => `<p class="text-sm">${i+1}) ${opt}</p>`).join('')}
                    </div>
                    <details class="mt-3 text-sm text-blue-600">
                        <summary class="cursor-pointer font-semibold text-green-600">ì •ë‹µ ë° í•´ì„¤ ë³´ê¸° (Giáº£i thÃ­ch)</summary>
                        <p class="mt-2 bg-white p-2 border-l-4 border-green-500 text-gray-700">
                            ì •ë‹µ: ${item.options[item.a]}<br>
                            ${item.explanation}
                        </p>
                    </details>
                `;
                container.appendChild(qEl);
            });
        }
        
        // ì´ˆê¸° ë¡œë“œ ì‹œ í‚¤ ì„¸íŒ…
        document.getElementById('apiKey').value = localStorage.getItem('groq_key') || '';
    </script>
</body>
</html>
